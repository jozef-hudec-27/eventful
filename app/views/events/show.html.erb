<div class="event-detail">
    <h2><%= @event.name %></h2>
    <p><%= @event.description %></p>

    <p><%= @event.attendees.count %> attendees</p>
    <p>Ticket price: <span class="event-info"><%=@event.ticket_price == 0 ? 'free' : "#{@event.ticket_price}$"%></span></p>
    <p>Organized by
        <span class="event-info">
        <% if @event.organizer == current_user %>
            me
        <% else %>
            <%=@event.organizer.username%>
        <% end %>
        </span>
    </p>

    <strong>When and where</strong>
    <p>Date and time: <span class="event-info"><%= @event.date&.strftime('%a, %d %b %Y, %l:%M %p') || 'NOT SPECIFIED YET' %></span></p>
    <p>Location: <span class="event-info"><%= @event.location %></span></p>

    <% if @event_ended %>
        <strong>Event has already taken place.</strong>
    <% end %>
</div>

<% if current_user == @event.organizer %>
    <%= link_to 'Delete', event_path(@event), data: { turbo_method: :delete, turbo_confirm: 'Are you sure you want to delete this event?' } %>
    <%= link_to 'Update', edit_event_path(@event) %>
    <p>Estimated earnings: <%=@event.attendees.count * @event.ticket_price%>$</p>
<% end %>

<% unless @event_ended %>
    <% if user_signed_in? && @event.organizer != current_user %>
        <form action="<%= event_register_toggle_path %>" style="display: none;" id="event-register-toggle-form" method="post">
            <input type="hidden" name="id" value="<%= @event.id %>">
        </form>

        <input type="submit"
            form="event-register-toggle-form"
            value="<% if @event.attendees.exists?(current_user.id) %>Unregister<% else %>Register<% end %>"
        >
    <% end %>
<% end %>